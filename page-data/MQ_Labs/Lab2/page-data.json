{"componentChunkName":"component---src-pages-mq-labs-lab-2-index-md","path":"/MQ_Labs/Lab2/","result":{"pageContext":{"frontmatter":{"title":"MQ Lab 1 - Configuring the IBM MQ JMS Provider"},"relativePagePath":"/MQ_Labs/Lab2/index.md","titleType":"page","MdxNode":{"id":"f8f5e699-6a2c-5ed0-8dfe-e427ca7aee8d","children":[],"parent":"a975b488-d7f9-53de-b4fe-7be34f8c9b58","internal":{"content":"---\ntitle: MQ Lab 1 - Configuring the IBM MQ JMS Provider\n---\r\n\r\n# Lab 2 - Configuring the IBM MQ JMS Provider \r\n\r\nThe purpose of this lab is to demonstrate some of the typical steps you will go through when configuring IBM MQ as a JMS provider. Some of the tasks that you will perform include:\r\n\r\n* Configure the Administered objects that a JMS program typically requires.\r\n    Administered objects are used to externalize **Connection Factories** and\r\n    **Destinations** from the program. This allows JMS Applications to be\r\n    portable between Messaging Providers by shielding the applications from\r\n    provider-specific details.\r\n\r\n* Define a **Java Naming and Directory Interface** (**JNDI) directory.** In\r\n    this lab you will perform the following:\r\n\r\n    * Create a JNDI directory\r\n\r\n    * Populate it with Connection Factory and Destination definitions\r\n\r\n    * Use the MQ Explorer wizard to create corresponding MQ definitions\r\n\r\n    * Run one of the Java™ Message Service (JMS) sample programs from the command line to use those definitions to connect to MQ as a JMS provider and produce JMS messages\r\n\r\n\r\n[View an overview of using JMS with IBM MQ](https://ibm.box.com/s/w6c73p1tanrosfzyc8z75h8ui0cngxya)\r\n\r\n## Create Administered Objects using MQ Explorer \r\n\r\nYou may use the same demo environment that you used for Lab 1. If you are doing this lab consecutively following Lab 1, you can continue with that environment. If you are doing this lab independent of Lab 1, you may need to create a new demo environment. In that case click the link below.\r\n\r\n[See the Environment Setup section](https://pages.github.ibm.com/cloudintegration/PoT-messaging/env_setup.html)    \r\n\r\n {% include note.html content=\"The following instructions assume that you are using the same demo environment from Lab 1. In this case you have created the **MQPOT** queue managers. If the MQPOT queue manager does not appear in the MQ Explorer, you must create it according to the instructions in Lab 1.\" %}\r\n   \r\n\r\n1. If the IBM MQ Explorer is not already running, you can launch it from the shortcut on the desktop.    \r\n![](images/image1.png)\r\n\r\n1.  Start the IBM MQ Explorer by double-clicking the **MQ\r\n    Explorer** shortcut.\r\n\r\n2.  A directory has been created on your image called C:\\\\PoT-messaging\\\\MQ-POT\\\\JMS. This directory will hold the JNDI Namespace. When you create a connection to the namespace a file named .bindings will be created in this directory.\r\n\r\n3.  Right-click **JMS Administered Objects** in the Navigator pane, and select **Add Initial Context…**.    \r\n    ![](images/image2.png)\r\n\r\n4.  On the **Connection details** screen, click **File System**. Then click\r\n    **Browse** to navigate to the directory called **C:\\\\PoT-messaging\\\\MQ-POT\\\\JMS**. Click **Next**.\r\n\r\n    ![](images/image3.png)\r\n\r\n5.  On the **User preferences** screen, enter the Context nickname **Context1**.\r\n    Note this can be a name of your choice but for this lab you will use\r\n    **Context1**. This name will not be used elsewhere. Check both the **Connect immediately on finish** and **Automatically reconnect to context on startup** checkboxes, and then click **Finish**.\r\n\r\n    ![](images/image4.png)\r\n\r\n6.  The newly created initial context is displayed in the list.    \r\n    ![](images/image5.png)\r\n\r\n    This concludes this portion of Lab 2.\r\n\r\n## Create a connection factory for IBM MQ\r\n\r\nA connection factory is the mechanism used by JMS to manage connections between your JMS application and the JMS Provider. You will now define a\r\nconnection factory in the JNDI namespace.\r\n\r\n1.  Expand the context name you just created. Right-click **Connection\r\n    Factories.** Select **New Connection Factory**. \r\n    ![](images/image6.png)\r\n\r\n1.  Enter the name **CF1**. Note this can be any name of your choice but for\r\n    this lab you will use CF1. This will be required when running the program so you might want to make note of it. Accept **IBM MQ** as the messaging provider and then click **Next \\>**.    \r\n    ![](images/image7.png)\r\n\r\n1.  On the next screen, accept the Type as **Connection Factory** and leave\r\n    **Support XA transactions** unchecked. Click **Next \\>**.   \r\n    ![](images/image8.png)\r\n\r\n1. On the next screen, accept **Bindings** as the Transport given we will run\r\n    the JMS Application on the same machine as the Queue Manager. Click **Next \\>**.     \r\n    ![](images/image9.png)\r\n\r\n1. On the next screen, leave **Create with attributes like an existing\r\n    connection factory** unchecked. Click **Next \\>**.\r\n\r\n    ![](images/image10.png)\r\n\r\n1. This will open the **New Connection Factory** property sheet. Select\r\n    **General** on the left hand menu **CF1** for *Name*. Use the pull-down to '8' for *Provider version*. This represents IBM MQ V8. Selecting this will enable JMS programs using this connection factory to utilize the new features of IBM MQ V8.   \r\n    \r\n    ![](images/image11.png)\r\n    \r\n1. Select **Connection** on the left hand menu. Click the **Select** button for **Base queue manager**.\n    \r\n    ![](images/image12.png)\r\n\r\n1. Select the previously-defined Queue Manager **MQPOT** and then click **OK**.   \r\n    ![](images/image13.png)\r\n\r\n1. Click **Finish** to create the connection factory.    \r\n    ![](images/image14.png)\r\n\r\n1. Click **OK** to dismiss the confirmation box.    \r\n    ![](images/image15.png)\r\n\r\n1. Observe that Connection Factory **CF1** now appears in the Context list.    \r\n    ![](images/image16.png)\r\n\r\n    This concludes this portion of Lab 2.\r\n\r\n## Create a Destination for the JMS Application to put a message onto\r\n\r\n1. Right-click **Destinations** and click **New Destination…**.\r\n\r\n    ![](images/image17.png)\r\n\r\n1. Enter the name **JMS1**. Note this can be any name of your choice but for this lab you will use **JMS1**. Leave the Type as **Queue** and ensure **Start wizard to create a matching MQ Queue** is checked. This will create\r\na corresponding IBM MQ Queue. The Queue that you create will be used\r\nto verify that messages are successfully written using the sample program.\r\nClick **Next \\>**.    \r\n    ![](images/image18.png)\r\n\r\n1. Accept the defaults on this next screen and click **Next \\>**.    \r\n    ![](images/image19.png)\r\n\r\n1. On the change properties screen, you can set some MQ-specific properties of the destination. Select **MQPOT** as the Queue Manager and define a Queue with the same name as the JMS Destination. Note the Queue name can be any name of your choice but for this lab you will use **JMS1**. This will be created as part of the upcoming wizard. Click **Finish** to launch the MQ configuration wizard.    \r\n    ![](images/image20.png)\r\n\r\n1. Click **OK** to dismiss the confirmation screen.    \r\n    ![](images/image21.png)\r\n\r\n1. The **Create an MQ Queue** wizard will start automatically. Click **Next\r\n    \\>**.     \r\n    ![](images/image22.png)\r\n\r\n1. Accept the default **Local Queue** for Type and then click **Next \\>**.   \r\n    ![](images/image23.png)\r\n\r\n1. Click **Finish** to create the MQ queue.    \r\n    ![](images/image24.png)\r\n\r\n1. Click **OK** to close the confirmation prompt.   \r\n    ![](images/image25.png)\r\n\r\n1. Click the **Queues** folder under MQPOT in the MQ Explorer Navigator pane.\r\n    Look at the Content pane to confirm that an MQ local queue called **JMS1** has been created.    \r\n    ![](images/image26.png)\r\n\r\nThis concludes this portion of Lab 2.\r\n\r\n## Writing a JMS message using a Java sample program\r\n\r\nSome very good code samples ship with IBM MQ. You will use one of them to create a JMS message on an MQ JMS queue.\r\n\r\n1.  Open a **command prompt**. A shortcut for this is on the desktop.    \r\n    ![](images/image27.png) \r\n\r\n2.  Change the directory to C:\\\\Program Files\\\\IBM\\\\MQ\\\\Tools\\\\jms\\\\samples. Enter the following commands to add **Java** to the *Path* and the required *JMS jar files* to your *Classpath*. \r\n\r\n    ```\n    set PATH=%PATH%C:\\Program Files\\Java\\jre1.8.0_jre\n    ```\n    \n    ```\n    set CLASSPATH=%CLASSPATH%C:\\Program Files\\IBM\\MQ\\java\\lib64;C:\\Program Files\\IBM\\MQ\\java\\lib\\com.ibm.mqjms.jar;C:\\Program Files\\IBM\\MQ\\java\\lib\\com.ibm.mq.jar;.;\n    ```\r\n    \n1. Now run the sample application:\n\r\n    ```\n    java JmsJndiProducer -i file:/c:/Pot-messaging/MQ-POT/JMS -c CF1 -d JMS1\n    ```\r\n\r\n    This will run the Java JMS sample program JmsJndiProducer. The **“-i”**\r\n    argument points the program to the location of your JNDI directory. The\r\n    **“-c CF1”** identifies the connection factory for your test queue manager, and the **“-d JMS1”** identifies the JMS destination queue.   \r\n    ![](images/image28.png)\r\n\r\n    Having run this program, you should now have a message in the **JMS1** queue. To see whether you do, you can look for the message that was produced by this program using the IBM MQ Explorer. Switch back to the MQ Explorer window.\r\n\r\n1.  In the MQ Explorer Navigator pane, locate the folder called **JMS\r\n    Administered Objects**. Click the **Destinations** folder beneath it, and in the Content pane you should see your JMS Destination **JMS1**. Double-click the **JMS1** destination to find the MQ Queue that is associated with it.    \r\n    ![](images/image29.png)\r\n\r\n1.  Recall that MQ queue **JMS1** is associated with the JMS destination\r\n    **JMS1**. Click **Cancel.**    \r\n    ![](images/image30.png)\r\n\r\n1.  Right-click the **JMS1** MQ queue object and then select **Browse\r\n    Messages…**.   \r\n    ![](images/image31.png)\r\n\r\n1.  The **message data** column in the display should match the message text\r\n    that you wrote with the JmsJndiProducer program.      \r\n    ![](images/image32.png)\r\n\r\n1.  Click **Close** to close the **Message browser**.    \r\n    ![](images/image33.png)\r\n\r\n    This concludes Lab 2.\r\n\r\n[Continue to Lab 3](mq_basic_pot_lab3.html)\r\n\r\n[Return MQ Basic Menu](mq_basic_pot_overview.html)\r\n","type":"Mdx","contentDigest":"32b4fab4531c844e56d540314a1d7a81","counter":939,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"MQ Lab 1 - Configuring the IBM MQ JMS Provider"},"exports":{},"rawBody":"---\ntitle: MQ Lab 1 - Configuring the IBM MQ JMS Provider\n---\r\n\r\n# Lab 2 - Configuring the IBM MQ JMS Provider \r\n\r\nThe purpose of this lab is to demonstrate some of the typical steps you will go through when configuring IBM MQ as a JMS provider. Some of the tasks that you will perform include:\r\n\r\n* Configure the Administered objects that a JMS program typically requires.\r\n    Administered objects are used to externalize **Connection Factories** and\r\n    **Destinations** from the program. This allows JMS Applications to be\r\n    portable between Messaging Providers by shielding the applications from\r\n    provider-specific details.\r\n\r\n* Define a **Java Naming and Directory Interface** (**JNDI) directory.** In\r\n    this lab you will perform the following:\r\n\r\n    * Create a JNDI directory\r\n\r\n    * Populate it with Connection Factory and Destination definitions\r\n\r\n    * Use the MQ Explorer wizard to create corresponding MQ definitions\r\n\r\n    * Run one of the Java™ Message Service (JMS) sample programs from the command line to use those definitions to connect to MQ as a JMS provider and produce JMS messages\r\n\r\n\r\n[View an overview of using JMS with IBM MQ](https://ibm.box.com/s/w6c73p1tanrosfzyc8z75h8ui0cngxya)\r\n\r\n## Create Administered Objects using MQ Explorer \r\n\r\nYou may use the same demo environment that you used for Lab 1. If you are doing this lab consecutively following Lab 1, you can continue with that environment. If you are doing this lab independent of Lab 1, you may need to create a new demo environment. In that case click the link below.\r\n\r\n[See the Environment Setup section](https://pages.github.ibm.com/cloudintegration/PoT-messaging/env_setup.html)    \r\n\r\n {% include note.html content=\"The following instructions assume that you are using the same demo environment from Lab 1. In this case you have created the **MQPOT** queue managers. If the MQPOT queue manager does not appear in the MQ Explorer, you must create it according to the instructions in Lab 1.\" %}\r\n   \r\n\r\n1. If the IBM MQ Explorer is not already running, you can launch it from the shortcut on the desktop.    \r\n![](images/image1.png)\r\n\r\n1.  Start the IBM MQ Explorer by double-clicking the **MQ\r\n    Explorer** shortcut.\r\n\r\n2.  A directory has been created on your image called C:\\\\PoT-messaging\\\\MQ-POT\\\\JMS. This directory will hold the JNDI Namespace. When you create a connection to the namespace a file named .bindings will be created in this directory.\r\n\r\n3.  Right-click **JMS Administered Objects** in the Navigator pane, and select **Add Initial Context…**.    \r\n    ![](images/image2.png)\r\n\r\n4.  On the **Connection details** screen, click **File System**. Then click\r\n    **Browse** to navigate to the directory called **C:\\\\PoT-messaging\\\\MQ-POT\\\\JMS**. Click **Next**.\r\n\r\n    ![](images/image3.png)\r\n\r\n5.  On the **User preferences** screen, enter the Context nickname **Context1**.\r\n    Note this can be a name of your choice but for this lab you will use\r\n    **Context1**. This name will not be used elsewhere. Check both the **Connect immediately on finish** and **Automatically reconnect to context on startup** checkboxes, and then click **Finish**.\r\n\r\n    ![](images/image4.png)\r\n\r\n6.  The newly created initial context is displayed in the list.    \r\n    ![](images/image5.png)\r\n\r\n    This concludes this portion of Lab 2.\r\n\r\n## Create a connection factory for IBM MQ\r\n\r\nA connection factory is the mechanism used by JMS to manage connections between your JMS application and the JMS Provider. You will now define a\r\nconnection factory in the JNDI namespace.\r\n\r\n1.  Expand the context name you just created. Right-click **Connection\r\n    Factories.** Select **New Connection Factory**. \r\n    ![](images/image6.png)\r\n\r\n1.  Enter the name **CF1**. Note this can be any name of your choice but for\r\n    this lab you will use CF1. This will be required when running the program so you might want to make note of it. Accept **IBM MQ** as the messaging provider and then click **Next \\>**.    \r\n    ![](images/image7.png)\r\n\r\n1.  On the next screen, accept the Type as **Connection Factory** and leave\r\n    **Support XA transactions** unchecked. Click **Next \\>**.   \r\n    ![](images/image8.png)\r\n\r\n1. On the next screen, accept **Bindings** as the Transport given we will run\r\n    the JMS Application on the same machine as the Queue Manager. Click **Next \\>**.     \r\n    ![](images/image9.png)\r\n\r\n1. On the next screen, leave **Create with attributes like an existing\r\n    connection factory** unchecked. Click **Next \\>**.\r\n\r\n    ![](images/image10.png)\r\n\r\n1. This will open the **New Connection Factory** property sheet. Select\r\n    **General** on the left hand menu **CF1** for *Name*. Use the pull-down to '8' for *Provider version*. This represents IBM MQ V8. Selecting this will enable JMS programs using this connection factory to utilize the new features of IBM MQ V8.   \r\n    \r\n    ![](images/image11.png)\r\n    \r\n1. Select **Connection** on the left hand menu. Click the **Select** button for **Base queue manager**.\n    \r\n    ![](images/image12.png)\r\n\r\n1. Select the previously-defined Queue Manager **MQPOT** and then click **OK**.   \r\n    ![](images/image13.png)\r\n\r\n1. Click **Finish** to create the connection factory.    \r\n    ![](images/image14.png)\r\n\r\n1. Click **OK** to dismiss the confirmation box.    \r\n    ![](images/image15.png)\r\n\r\n1. Observe that Connection Factory **CF1** now appears in the Context list.    \r\n    ![](images/image16.png)\r\n\r\n    This concludes this portion of Lab 2.\r\n\r\n## Create a Destination for the JMS Application to put a message onto\r\n\r\n1. Right-click **Destinations** and click **New Destination…**.\r\n\r\n    ![](images/image17.png)\r\n\r\n1. Enter the name **JMS1**. Note this can be any name of your choice but for this lab you will use **JMS1**. Leave the Type as **Queue** and ensure **Start wizard to create a matching MQ Queue** is checked. This will create\r\na corresponding IBM MQ Queue. The Queue that you create will be used\r\nto verify that messages are successfully written using the sample program.\r\nClick **Next \\>**.    \r\n    ![](images/image18.png)\r\n\r\n1. Accept the defaults on this next screen and click **Next \\>**.    \r\n    ![](images/image19.png)\r\n\r\n1. On the change properties screen, you can set some MQ-specific properties of the destination. Select **MQPOT** as the Queue Manager and define a Queue with the same name as the JMS Destination. Note the Queue name can be any name of your choice but for this lab you will use **JMS1**. This will be created as part of the upcoming wizard. Click **Finish** to launch the MQ configuration wizard.    \r\n    ![](images/image20.png)\r\n\r\n1. Click **OK** to dismiss the confirmation screen.    \r\n    ![](images/image21.png)\r\n\r\n1. The **Create an MQ Queue** wizard will start automatically. Click **Next\r\n    \\>**.     \r\n    ![](images/image22.png)\r\n\r\n1. Accept the default **Local Queue** for Type and then click **Next \\>**.   \r\n    ![](images/image23.png)\r\n\r\n1. Click **Finish** to create the MQ queue.    \r\n    ![](images/image24.png)\r\n\r\n1. Click **OK** to close the confirmation prompt.   \r\n    ![](images/image25.png)\r\n\r\n1. Click the **Queues** folder under MQPOT in the MQ Explorer Navigator pane.\r\n    Look at the Content pane to confirm that an MQ local queue called **JMS1** has been created.    \r\n    ![](images/image26.png)\r\n\r\nThis concludes this portion of Lab 2.\r\n\r\n## Writing a JMS message using a Java sample program\r\n\r\nSome very good code samples ship with IBM MQ. You will use one of them to create a JMS message on an MQ JMS queue.\r\n\r\n1.  Open a **command prompt**. A shortcut for this is on the desktop.    \r\n    ![](images/image27.png) \r\n\r\n2.  Change the directory to C:\\\\Program Files\\\\IBM\\\\MQ\\\\Tools\\\\jms\\\\samples. Enter the following commands to add **Java** to the *Path* and the required *JMS jar files* to your *Classpath*. \r\n\r\n    ```\n    set PATH=%PATH%C:\\Program Files\\Java\\jre1.8.0_jre\n    ```\n    \n    ```\n    set CLASSPATH=%CLASSPATH%C:\\Program Files\\IBM\\MQ\\java\\lib64;C:\\Program Files\\IBM\\MQ\\java\\lib\\com.ibm.mqjms.jar;C:\\Program Files\\IBM\\MQ\\java\\lib\\com.ibm.mq.jar;.;\n    ```\r\n    \n1. Now run the sample application:\n\r\n    ```\n    java JmsJndiProducer -i file:/c:/Pot-messaging/MQ-POT/JMS -c CF1 -d JMS1\n    ```\r\n\r\n    This will run the Java JMS sample program JmsJndiProducer. The **“-i”**\r\n    argument points the program to the location of your JNDI directory. The\r\n    **“-c CF1”** identifies the connection factory for your test queue manager, and the **“-d JMS1”** identifies the JMS destination queue.   \r\n    ![](images/image28.png)\r\n\r\n    Having run this program, you should now have a message in the **JMS1** queue. To see whether you do, you can look for the message that was produced by this program using the IBM MQ Explorer. Switch back to the MQ Explorer window.\r\n\r\n1.  In the MQ Explorer Navigator pane, locate the folder called **JMS\r\n    Administered Objects**. Click the **Destinations** folder beneath it, and in the Content pane you should see your JMS Destination **JMS1**. Double-click the **JMS1** destination to find the MQ Queue that is associated with it.    \r\n    ![](images/image29.png)\r\n\r\n1.  Recall that MQ queue **JMS1** is associated with the JMS destination\r\n    **JMS1**. Click **Cancel.**    \r\n    ![](images/image30.png)\r\n\r\n1.  Right-click the **JMS1** MQ queue object and then select **Browse\r\n    Messages…**.   \r\n    ![](images/image31.png)\r\n\r\n1.  The **message data** column in the display should match the message text\r\n    that you wrote with the JmsJndiProducer program.      \r\n    ![](images/image32.png)\r\n\r\n1.  Click **Close** to close the **Message browser**.    \r\n    ![](images/image33.png)\r\n\r\n    This concludes Lab 2.\r\n\r\n[Continue to Lab 3](mq_basic_pot_lab3.html)\r\n\r\n[Return MQ Basic Menu](mq_basic_pot_overview.html)\r\n","fileAbsolutePath":"/Users/carnesjus.ibm.com/GitHub/potlabs/src/pages/MQ_Labs/Lab2/index.md"}}},"staticQueryHashes":["1054721580","1054721580","1364590287","2102389209","2102389209","2456312558","2746626797","2746626797","3018647132","3018647132","3037994772","3037994772","768070550"]}